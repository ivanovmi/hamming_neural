#!/usr/bin/env python
# -- coding: utf-8 --

import neurolab.net
import neurolab.trans
import numpy as np

__author__ = 'michael'

target = np.ones((10, 40), dtype=np.float)

target[0, :] = np.array([0, 1, 1, 1, 0,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         0, 1, 1, 1, 0])

target[1, :] = np.array([0, 0, 1, 0, 0,
                         0, 1, 1, 0, 0,
                         1, 0, 1, 0, 0,
                         0, 0, 1, 0, 0,
                         0, 0, 1, 0, 0,
                         0, 0, 1, 0, 0,
                         0, 0, 1, 0, 0,
                         1, 1, 1, 1, 1])

target[2, :] = np.array([0, 1, 1, 1, 0,
                         1, 0, 0, 0, 1,
                         0, 0, 0, 0, 1,
                         0, 0, 0, 0, 1,
                         0, 0, 1, 1, 0,
                         0, 1, 0, 0, 0,
                         1, 0, 0, 0, 0,
                         1, 1, 1, 1, 1])

target[3, :] = np.array([0, 1, 1, 1, 0,
                         1, 0, 0, 0, 1,
                         0, 0, 0, 0, 1,
                         0, 0, 1, 1, 0,
                         0, 0, 1, 1, 0,
                         0, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         0, 1, 1, 1, 0])

target[4, :] = np.array([0, 0, 1, 1, 0,
                         0, 1, 0, 1, 0,
                         1, 0, 0, 1, 0,
                         1, 0, 0, 1, 0,
                         1, 1, 1, 1, 1,
                         0, 0, 0, 1, 0,
                         0, 0, 0, 1, 0,
                         0, 0, 0, 1, 0])

target[5, :] = np.array([1, 1, 1, 1, 1,
                         1, 0, 0, 0, 0,
                         1, 0, 0, 0, 0,
                         0, 1, 1, 1, 0,
                         0, 0, 0, 0, 1,
                         0, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         0, 1, 1, 1, 0])

target[6, :] = np.array([0, 1, 1, 1, 0,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 0,
                         0, 1, 1, 1, 0,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         0, 1, 1, 1, 0])

target[7, :] = np.array([1, 1, 1, 1, 1,
                         0, 0, 0, 0, 1,
                         0, 0, 0, 1, 0,
                         0, 0, 1, 0, 0,
                         0, 0, 1, 0, 0,
                         0, 0, 1, 0, 0,
                         0, 0, 1, 0, 0,
                         0, 0, 1, 0, 0])

target[8, :] = np.array([0, 1, 1, 1, 0,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         0, 1, 1, 1, 0,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         0, 1, 1, 1, 0])

target[9, :] = np.array([0, 1, 1, 1, 0,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         0, 1, 1, 1, 1,
                         0, 0, 0, 0, 1,
                         1, 0, 0, 0, 1,
                         0, 1, 1, 1, 0])


def train(target):
    # Create and train network
    neuron = neurolab.net.newhem(target, neurolab.trans.SatLinPrm(1, 0, 100), 1000)
    neuron.sim(target)
    return neuron

input = [0,1,1,1,0,1,0,0,0,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,0,0,1,1,0,0,0,1,0,1,1,1,0]#[[1, 1, 1, 0, 0, 1, 0, 1, 1, 0, 0, 1, 1, 1, 1]]

def get_output(input, target):
    neuron = train(target)
    output = neuron.sim([input])
    return output
